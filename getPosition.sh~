#!/bin/bash

yes="y"
no="n"

echo Enter filename, without extension
read filename

echo Do you want to process RAW to RINEX? y/n
read response

BASEDIR=$PWD
RTKpath=$BASEDIR"/RTKLIB-demo5/app/consapp/convbin/gcc"

if [ $response == $yes ]; then

    ubxFILE=$filename".ubx"
    echo RINEX now processing: $filename
    cd $RTKpath
    RAWPATH=$BASEDIR"/tempData/"$filename
    echo $RAWPATH

    ./convbin -r ubx $RAWPATH -v 2.11
fi


echo Do you want to process position? y/n
read response

if [ $response == $yes ]; then
    newFILE=${filename##*}
    echo $newFILE
    OBFILE=$BASEDIR"/tempData/"$newFILE".o"
    NAVFILE=$BASEDIR"/tempData/"$newFILE".nav"
    cd ../..
    cd rnx2rtkp/gcc
    ./rnx2rtkp -p 0 -m 15 -e -u $OBFILE $NAVFILE
 fi

echo Do you want to process statistics? y/n
read response

if [ $response == $yes ]; then
    echo Python will automatically process the .pos file \in /tempData
    cd $BASEDIR
    source env/bin/activate
    python3 dataAnalysis.py
 fi
